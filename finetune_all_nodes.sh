#!/bin/bash

# Path to the Python script
python_script="python finetune.py"

# Base arguments
base_args="/home/neil/Lab_work/Jeong_Lab_Multi_Modal_MRI/magmsEZpred/pretrained_models/magms_ALL_mod_WB_fold1.exp/checkpoints/best_accuracy.model"

# Input and output directories
input_dir="/home/neil/Lab_work/Jeong_Lab_Multi_Modal_MRI/magmsEZpred/Node_Level_Data/"
output_dir="/home/neil/Lab_work/Jeong_Lab_Multi_Modal_MRI/magmsEZpred/finetuned_node_level_models/"

# The node numbers which require finetuning
list_nums=(1 13 41 44 45 46 68 72 83 94 95 96 107 121 124 125 127 130 132 135 140 144 145 148 151 175 185 194 202 204 205 209 210 215 220 221 222 224 226 249 254 256 261 262 263 275 300 306 316 320 326 327 332 339 349 353 356 359 360 363 367 373 384 386 387 388 391 407 432 501 503 504 505 521 522 531 533 544 565 571 575 578 581 606 620 626 636 637 644 650 663 670 675 679 686 687 688 690 691 707 717 722 725 726 727 728 730 751 756 764 770 780 781 782 785 793 794 795 798 803 804 805 807 808 817 820 822 823 834 836 839 844 847 851 852 862 863 864 870 871 873 874 877 881 888 895 927 953 962 978 3 5 11 12 47 48 49 84 87 88 155 157 160 162 168 225 227 229 232 247 248 250 252 394 396 468 511 516 530 545 548 556 557 572 579 582 586 590 593 600 601 605 612 616 619 621 632 633 651 652 653 655 667 671 674 676 700 701 716 718 720 723 731 732 733 737 758 783 800 818 824 826 830 885 890 891 905 938 961 963 979 163 435 517 539 634 635 2 30 35 43 60 64 66 69 79 80 91 92 93 103 122 128 133 149 152 177 197 255 260 289 290 292 301 303 322 325 364 365 366 374 425 434 448 508 562 569 583 599 662 681 761 763 765 766 776 792 806 810 837 846 850 853 855 865 879 880 887 928 959 966 20 36 42 86 228 245 251 395 399 404 405 406 426 439 463 512 529 536 564 570 574 584 585 587 604 607 622 672 677 678 694 703 711 712 713 714 719 735 738 744 748 750 759 760 799 819 825 867 886 921 922 937 971 975 19 158 164 166 230 231 233 234 400 403 409 410 436 447 456 459 461 462 469 473 474 475 476 510 514 540 547 563 573 591 595 610 614 623 627 628 630 639 641 642 649 673 697 741 747 894 896 897 900 903 915 920 925 943 946 947 958 964 980 981 419 553 55 112 131 291 294 295 299 346 352 368 431 705 769 778 779 786 868 882 940 956 159 239 246 441 455 525 588 609 625 695 715 739 742 743 788 790 801 859 866 892 893 924 926 934 951 6 165 235 398 414 438 440 446 460 467 477 478 479 509 515 535 549 560 561 567 592 596 603 608 613 618 624 638 696 699 740 746 828 829 899 906 908 923 936 949 950 970 18 33 402 411 412 413 420 442 466 470 472 513 519 520 541 542 552 554 558 559 646 648 827 901 913 918 919 945 968 969 976 977 50 51 57 61 67 257 357 370 427 430 454 771 848 930 39 422 423 543 566 797 831 167 397 437 444 445 538 594 698 745 898 907 935 965 58 63 287 298 428 932 415 417 418 443 464 518 537 602 647 917 941 942 948 973 974 34 424 933 401 471 902 910 914 421 568 615 629 957 296 931 465 944 416 904 909 916 912 56 551 787 555 911)

# Additional arguments
other_args="-b 16 -lr 3e-4 --num_mod 5 -e 15 --replace_experiment --device cuda:0"

# Loop through the custom list of numbers
for node_num in "${list_nums[@]}"; do
    echo "Running with node_num = $node_num"
    exp_name="magms_ALL_mod_WB_fold1_node_${node_num}_finetuned.exp"
    node_output_dir="${output_dir}magms_ALL_mod_WB_fold1_node_${node_num}_finetuned.model"
    full_command="$python_script $base_args --node_num $node_num $input_dir $node_output_dir -exp $exp_name $other_args"
    echo "Executing command: $full_command"
    $full_command
    echo "Finished running with node_num = $node_num"

    echo -e "\n"
done

